{% extends 'base.html' %}
{% load thumbnail %}
{% load static %}
{% block title %}
  Лента
{% endblock %}
{% block before-content %}
{% if tapes.background %}
  <div class="row container-fluid profile-top">
    <div class="col-3">
      {{ tapes.background }}
    </div>
    <div class="col-6 profile-background-img" style="background-image: url('{{ tapes.background.url }}'); background-position: top left; background-size: inherit;">
    </div>
  </div>
{% else %}
<div class="row container-fluid profile-top">
  <div class="col-3">
    {{ tapes.background }}
  </div>
  <div class="col-6 profile-background-img" style="background-image: url('{{ author.background.url }}'); background-position: top left; background-size: inherit;">
  </div>
</div>
{% endif %}
{% endblock %}
{% block content %}
<div class="row profile">
  <div class="col-6 profile-name">
    {% thumbnail tapes.picture "220x220" as im %}
      <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" class="tape-picture">
    {% endthumbnail %}
    <h1 class="fw-bolder">
      {{ tapes.title }}
    </h1>
  </div>

  <div class="col-6 subscribe text-end ms-auto mt-auto mb-0">
    {% if request.user.is_staff and request.user != author %}
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-sliders" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M11.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM9.05 3a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0V3h9.05zM4.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2.05 8a2.5 2.5 0 0 1 4.9 0H16v1H6.95a2.5 2.5 0 0 1-4.9 0H0V8h2.05zm9.45 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm-2.45 1a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0v-1h9.05z"/>
      </svg>
    {% endif %}
    {% if request.user != author %}
      {% if is_sub %}
        <a href="#" class="notice">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-broadcast" viewBox="0 0 16 16">
            <path d="M3.05 3.05a7 7 0 0 0 0 9.9.5.5 0 0 1-.707.707 8 8 0 0 1 0-11.314.5.5 0 0 1 .707.707zm2.122 2.122a4 4 0 0 0 0 5.656.5.5 0 1 1-.708.708 5 5 0 0 1 0-7.072.5.5 0 0 1 .708.708zm5.656-.708a.5.5 0 0 1 .708 0 5 5 0 0 1 0 7.072.5.5 0 1 1-.708-.708 4 4 0 0 0 0-5.656.5.5 0 0 1 0-.708zm2.122-2.12a.5.5 0 0 1 .707 0 8 8 0 0 1 0 11.313.5.5 0 0 1-.707-.707 7 7 0 0 0 0-9.9.5.5 0 0 1 0-.707zM10 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"/>
          </svg>
        </a>
        <a
          class="btn btn-lg btn-light sub-true"
          href="{% url 'tape:unsubscribe' author.username %}" role="button"
        >
          Вы подписаны
        </a>
      {% else %}
          <a
            class="btn btn-lg btn-primary"
            href="{% url 'tape:subscribe' author.username %}" role="button"
          >
            Подписаться
          </a>
       {% endif %}
    {% else %}
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-sliders" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M11.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM9.05 3a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0V3h9.05zM4.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2.05 8a2.5 2.5 0 0 1 4.9 0H16v1H6.95a2.5 2.5 0 0 1-4.9 0H0V8h2.05zm9.45 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm-2.45 1a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0v-1h9.05z"/>
      </svg>
      <a
        class="btn btn-lg btn-primary"
        href="{% url 'tape:tape_edit' slug=tapes.slug username=request.user.username %}" role="button"
      >
        Редактировать
      </a>
    {% endif %}
  </div>


    {% if tapes.description %}
      <div class="col-12 about-me">
        {{ tapes.description }}
      </div>
    {% endif %}


<div class="infinite-container">
  {% for entry in entries %}
      {% include '../includes/entry.html' %}
  {% endfor %}
</div>
{% include '../includes/infinite-scroll.html' %}
{% endblock %}
