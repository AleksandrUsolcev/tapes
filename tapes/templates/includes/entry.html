{% load humanize %}
{% load thumbnail %}
<div class="infinite-item">
  <div class="entry-content">
    <div class="head row">
      {% if entry.title %}
        <h3>
          {{ entry.title }}
        </h3>
      {% endif %}
      <div class="col-8 entry-names">
          <a href="{% url 'tape:profile' entry.author.username %}">
            {% thumbnail entry.author.avatar "20x20" crop="center" as im %}
              <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" class="profile-avatar-mini">
            {% endthumbnail %}
            <span class="fw-bold">
              ~{% if entry.author.display_username %}{{ entry.author.display_username }}{% else %}{{ entry.author.username }}{% endif %}
            </span>
            {% if entry.author.username == 'hexen' %}
              <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="currentColor" class="bi bi-patch-check-fill" viewBox="0 0 16 16">
                <path d="M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708z"/>
              </svg>
            {% endif %}
          </a>

        {% if entry.author.full_name and entry.author.show_full_name %}
          <span class="fw-bold full-name">{{ entry.author.full_name }}</span>
        {% endif %}
      </div>
      <div class="col-4 text-end">
          <span class="fw-light">
            {% if today_time == entry.created.date %}
              {{ entry.created|naturaltime }}
            {% else %}
              {{ entry.created|naturalday }}
            {% endif %}
          </span>
      </div>
      {% if entry.tape %}
      <div class="col-12 tape">
        <span class="fw-bolder">
          <a href="{% url 'tape:tape' entry.author.username entry.tape.slug %}">
          {{ entry.tape.title }}</a>
        </span>
      </div>
      {% endif %}
    </div>
    {% if entry.text %}
      <p class="py-3 m-0">
        {{ entry.text }}
      </p>
    {% endif %}



    <div class="pb-5" id='comments'>
      <a href="{% url 'tape:entry_detail' entry.id %}#comments" class="text-decoration-none me-4">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
          <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
          <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"/>
        </svg>
        <span class="fw-light ms-1">{{ entry.comments.count }}</span>
      </a>

    {% if request.user.is_authenticated and entry.id in marked %}
      <a class="text-decoration-none me-4" href="{% url 'tape:unmark' entry.id %}">
        {% csrf_token %}
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark-check-fill" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M2 15.5V2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l-5.26 2.87A.5.5 0 0 1 2 15.5zm8.854-9.646a.5.5 0 0 0-.708-.708L7.5 7.793 6.354 6.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"/>
        </svg>
        <span class="fw-light ms-1">{{ entry.marked.count }}</span>
      </a>
    {% else %}
      <a class="text-decoration-none me-4" href="{% url 'tape:mark_add' entry.id %}">
        {% csrf_token %}
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
          <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>
        </svg>
        <span class="fw-light ms-1">{{ entry.marked.count }}</span>
      </a>
    {% endif %}


    {% if request.user.is_authenticated and entry.id in liked %}
      <a class="text-decoration-none me-4" href="{% url 'tape:dislike' entry.id %}">
        {% csrf_token %}
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
        </svg>
        <span class="fw-light ms-1">{{ entry.liked.count }}</span>
      </a>
    {% else %}
      <a class="text-decoration-none me-4" href="{% url 'tape:like_add' entry.id %}">
        {% csrf_token %}
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
          <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
        </svg>
        <span class="fw-light ms-1">{{ entry.liked.count }}</span>
      </a>
    {% endif %}

    <a href="" class="text-decoration-none me-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
        <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
        <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
      </svg>
    </a>

    </div>
  </div>
</div>
